# NVIDIA A100-SXM4-40GB Benchmark Data
# 10 runs per configuration

GPU_NAME = "A100"
GPU_DISPLAY_NAME = "A100"

# ==============================================================================
# Element-wise Addition
# ==============================================================================
ADD_FP32 = {
    "unfused": [6.6, 6.5, 6.6, 11.9, 159.2, 1507.4],
    "unfused_std": [0.4, 0.1, 0.4, 1.0, 2.2, 3.0],
    "fused": [3.4, 3.2, 3.4, 6.0, 94.1, 897.9],
    "fused_std": [0.5, 0.1, 0.6, 0.5, 0.9, 0.8],
    "speedup": [1.97, 2.02, 1.95, 1.99, 1.69, 1.68],
    "speedup_std": [0.14, 0.06, 0.24, 0.05, 0.03, 0.00],
    "bw_unfused": [3.1, 31.4, 311.8, 1737.4, 1286.5, 1358.7],
    "bw_unfused_std": [0.2, 0.6, 14.6, 124.5, 17.4, 2.7],
    "bw_fused": [3.7, 38.1, 365.0, 2073.3, 1306.2, 1368.5],
    "bw_fused_std": [0.4, 1.0, 48.3, 147.9, 12.3, 1.3],
}

ADD_FP16 = {
    "unfused": [6.6, 6.5, 6.7, 11.4, 100.4, 936.3],
    "unfused_std": [0.4, 0.1, 0.5, 0.4, 1.1, 46.2],
    "fused": [3.2, 3.2, 3.4, 5.7, 52.5, 499.5],
    "fused_std": [0.1, 0.1, 0.3, 0.1, 0.1, 22.0],
    "speedup": [2.05, 2.03, 1.97, 2.01, 1.91, 1.88],
    "speedup_std": [0.12, 0.06, 0.07, 0.06, 0.02, 0.01],
    "bw_unfused": [1.6, 15.7, 154.6, 902.9, 1020.3, 1095.8],
    "bw_unfused_std": [0.1, 0.2, 10.4, 27.1, 10.9, 48.0],
    "bw_fused": [1.9, 19.2, 183.1, 1087.6, 1171.0, 1232.0],
    "bw_fused_std": [0.1, 0.4, 12.8, 11.2, 2.1, 48.8],
}

# ==============================================================================
# Fused Multiply-Add (FMA)
# ==============================================================================
FMA_FP32 = {
    "unfused": [6.4, 6.4, 6.4, 12.0, 187.3, 1796.2],
    "unfused_std": [0.2, 0.1, 0.1, 0.6, 1.0, 0.6],
    "fused": [3.3, 3.2, 3.3, 6.3, 123.0, 1183.4],
    "fused_std": [0.1, 0.1, 0.2, 0.4, 1.0, 1.1],
    "speedup": [1.99, 1.99, 1.94, 1.92, 1.52, 1.52],
    "speedup_std": [0.06, 0.05, 0.12, 0.13, 0.00, 0.00],
    "bw_unfused": [3.8, 38.5, 383.9, 2053.9, 1312.1, 1368.2],
    "bw_unfused_std": [0.1, 0.4, 4.7, 89.4, 6.8, 0.4],
    "bw_fused": [5.1, 51.0, 496.1, 2629.9, 1331.8, 1384.5],
    "bw_fused_std": [0.1, 1.2, 27.2, 133.7, 10.7, 1.3],
}

FMA_FP16 = {
    "unfused": [6.6, 6.7, 6.6, 11.5, 105.4, 997.6],
    "unfused_std": [0.3, 0.5, 0.4, 0.2, 1.7, 41.5],
    "fused": [3.3, 3.3, 3.5, 5.9, 65.7, 613.9],
    "fused_std": [0.2, 0.2, 0.7, 0.0, 0.0, 0.4],
    "speedup": [2.00, 2.03, 1.91, 1.94, 1.61, 1.62],
    "speedup_std": [0.04, 0.08, 0.23, 0.03, 0.03, 0.07],
    "bw_unfused": [1.9, 18.5, 187.6, 1070.5, 1165.9, 1233.5],
    "bw_unfused_std": [0.1, 1.3, 10.9, 14.4, 18.1, 46.4],
    "bw_fused": [2.5, 25.0, 239.2, 1386.8, 1246.2, 1334.4],
    "bw_fused_std": [0.1, 1.3, 35.5, 7.5, 0.8, 0.9],
}

# ==============================================================================
# ReLU
# ==============================================================================
RELU_FP32 = {
    "unfused": [9.7, 9.9, 9.8, 17.7, 223.0, 2113.7],
    "unfused_std": [0.1, 0.6, 0.5, 1.4, 2.2, 1.9],
    "fused": [3.5, 3.2, 3.4, 6.1, 94.1, 897.8],
    "fused_std": [0.6, 0.1, 0.3, 0.5, 0.6, 0.3],
    "speedup": [2.85, 3.05, 2.91, 2.91, 2.37, 2.35],
    "speedup_std": [0.37, 0.14, 0.16, 0.01, 0.02, 0.00],
    "bw_unfused": [3.0, 29.0, 293.3, 1623.8, 1285.8, 1356.5],
    "bw_unfused_std": [0.0, 1.5, 13.3, 109.2, 12.5, 1.2],
    "bw_fused": [3.6, 37.9, 366.0, 2027.3, 1305.7, 1368.7],
    "bw_fused_std": [0.5, 1.2, 28.3, 142.5, 7.8, 0.5],
}

RELU_FP16 = {
    "unfused": [9.6, 10.1, 9.9, 16.9, 146.0, 1368.3],
    "unfused_std": [0.1, 0.8, 0.5, 0.1, 0.2, 71.2],
    "fused": [3.2, 3.2, 3.3, 5.8, 52.8, 494.5],
    "fused_std": [0.1, 0.1, 0.2, 0.0, 0.1, 2.8],
    "speedup": [2.99, 3.13, 3.05, 2.92, 2.77, 2.77],
    "speedup_std": [0.08, 0.24, 0.15, 0.01, 0.01, 0.13],
    "bw_unfused": [1.5, 14.3, 145.2, 847.9, 981.8, 1050.0],
    "bw_unfused_std": [0.0, 1.0, 7.2, 6.7, 1.4, 48.3],
    "bw_fused": [1.9, 19.1, 189.3, 1061.7, 1163.6, 1242.5],
    "bw_fused_std": [0.1, 0.3, 8.3, 6.4, 3.0, 7.0],
}

# ==============================================================================
# Map Reduce - Naive Implementation
# ==============================================================================
MAP_REDUCE_NAIVE_FP32 = {
    "unfused": [10.1, 33.7, 274.9, 2423.9, 22846.5, 228570.0],
    "unfused_std": [1.1, 4.5, 34.5, 135.0, 3.9, 40.8],
    "fused": [7.2, 30.9, 271.5, 2280.1, 22771.1, 227827.9],
    "fused_std": [0.8, 3.7, 34.1, 0.8, 5.3, 22.4],
    "speedup": [1.40, 1.09, 1.01, 1.06, 1.00, 1.00],
    "speedup_std": [0.01, 0.04, 0.00, 0.06, 0.00, 0.00],
    "bw_unfused": [1.6, 4.9, 6.1, 6.8, 7.2, 7.2],
    "bw_unfused_std": [0.2, 0.7, 0.8, 0.4, 0.0, 0.0],
    "bw_fused": [1.2, 2.7, 3.1, 3.6, 3.6, 3.6],
    "bw_fused_std": [0.1, 0.3, 0.4, 0.0, 0.0, 0.0],
}

MAP_REDUCE_NAIVE_FP16 = {
    "unfused": [443.2, 5172.1, 59872.3, 204478.0, 214845.1, 317961.1],
    "unfused_std": [58.5, 122.7, 46.5, 499.0, 765.6, 551.4],
    "fused": [440.7, 5096.9, 59785.2, 204925.9, 213537.7, 310504.6],
    "fused_std": [58.2, 8.7, 54.1, 720.9, 798.8, 474.6],
    "speedup": [1.01, 1.02, 1.00, 1.00, 1.00, 1.02],
    "speedup_std": [0.00, 0.02, 0.00, 0.00, 0.01, 0.01],
    "bw_unfused": [0.0, 0.0, 0.0, 0.0, 0.4, 2.6],
    "bw_unfused_std": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    "bw_fused": [0.0, 0.0, 0.0, 0.0, 0.2, 1.3],
    "bw_fused_std": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
}

# ==============================================================================
# Map Reduce - Block-level Implementation
# ==============================================================================
MAP_REDUCE_BLOCK_FP32 = {
    "unfused": [8.4, 8.4, 9.3, 21.0, 179.6, 1784.8],
    "unfused_std": [0.0, 0.1, 0.1, 0.1, 0.1, 0.9],
    "fused": [5.7, 5.7, 6.4, 15.6, 96.2, 898.1],
    "fused_std": [0.0, 0.0, 0.0, 0.7, 0.1, 0.4],
    "speedup": [1.48, 1.46, 1.46, 1.35, 1.87, 1.99],
    "speedup_std": [0.01, 0.01, 0.01, 0.06, 0.00, 0.00],
    "bw_unfused": [2.0, 19.6, 176.1, 780.8, 912.1, 918.0],
    "bw_unfused_std": [0.0, 0.2, 1.4, 3.0, 0.4, 0.4],
    "bw_fused": [1.5, 14.3, 128.2, 527.1, 851.2, 912.2],
    "bw_fused_std": [0.0, 0.1, 0.9, 23.0, 0.6, 0.4],
}

MAP_REDUCE_BLOCK_FP16 = {
    "unfused": [6.5, 6.5, 7.2, 36.3, 249.8, 2361.8],
    "unfused_std": [0.1, 0.1, 0.1, 0.1, 0.2, 0.7],
    "fused": [3.8, 3.9, 4.3, 31.0, 214.0, 2000.2],
    "fused_std": [0.0, 0.0, 0.0, 0.2, 0.2, 1.2],
    "speedup": [1.70, 1.69, 1.67, 1.17, 1.17, 1.18],
    "speedup_std": [0.01, 0.01, 0.01, 0.01, 0.00, 0.00],
    "bw_unfused": [1.3, 12.6, 113.5, 225.5, 327.9, 346.9],
    "bw_unfused_std": [0.0, 0.1, 1.0, 0.7, 0.2, 0.1],
    "bw_fused": [1.1, 10.6, 94.6, 132.2, 191.4, 204.8],
    "bw_fused_std": [0.0, 0.1, 0.7, 0.7, 0.2, 0.1],
}

# ==============================================================================
# Map Reduce - Mixed Precision Implementation - Naive
# ==============================================================================
MAP_REDUCE_MIXED_NAIVE = {
    "unfused": [9.0, 29.4, 234.7, 2285.5, 22812.1, 228092.5], 
    "unfused_std": [0.1, 0.1, 0.2, 0.1, 0.1, 1.8],
    "fused": [6.5, 26.9, 231.8, 2279.9, 22761.0, 227683.0],
    "fused_std": [0.0, 0.1, 0.1, 0.0, 0.1, 4.5],
    "speedup": [1.39, 1.09, 1.01, 1.00, 1.00, 1.00],
    "speedup_std": [0.01, 0.01, 0.00, 0.00, 0.00, 0.00],
    "bw_unfused": [0.9, 2.8, 3.5, 3.6, 3.6, 3.6],
    "bw_unfused_std": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    "bw_fused": [0.6, 1.5, 1.8, 1.8, 1.8, 1.8],
    "bw_fused_std": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
}

MAP_REDUCE_MIXED_BLOCK = {
    "unfused": [8.5, 8.4, 9.2, 21.1, 146.9, 1385.6],
    "unfused_std": [0.1, 0.1, 0.1, 0.1, 0.5, 0.7],
    "fused": [5.7, 5.8, 6.3, 15.6, 95.9, 896.9],
    "fused_std": [0.0, 0.1, 0.0, 0.0, 0.1, 0.9],
    "speedup": [1.50, 1.46, 1.46, 1.36, 1.53, 1.55],
    "speedup_std": [0.02, 0.02, 0.01, 0.01, 0.00, 0.00],
    "bw_unfused": [1.0, 9.8, 89.5, 388.7, 557.6, 591.2],
    "bw_unfused_std": [0.0, 0.1, 0.6, 1.2, 1.9, 0.3],
    "bw_fused": [0.7, 7.1, 65.2, 263.3, 427.1, 456.7],
    "bw_fused_std": [0.0, 0.1, 0.2, 0.6, 0.4, 0.5],
}

# ==============================================================================
# Plot configuration (y_max values for consistent scaling)
# A100 has high bandwidth (~1555 GB/s theoretical, ~1300-1400 GB/s achieved)
# ==============================================================================
PLOT_CONFIG = {
    "add": {"speedup_y_max": 2.5, "bandwidth_y_max": 2500},
    "fma": {"speedup_y_max": 2.5, "bandwidth_y_max": 3000},
    "relu": {"speedup_y_max": 3.5, "bandwidth_y_max": 2500},
    "map_reduce_naive": {"speedup_y_max": 1.75, "bandwidth_y_max": 15, "use_log_scale": False},
    "map_reduce_block": {"speedup_y_max": 2.25, "bandwidth_y_max": 1000},
    "map_reduce_mixed_naive": {"speedup_y_max": 1.75, "bandwidth_y_max": 500},
    "map_reduce_mixed_block": {"speedup_y_max": 1.75, "bandwidth_y_max": 500},
}